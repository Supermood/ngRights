!function(t){t.module("ngRights",["ngRightsProvider","ngRightsDirective"])}(angular),angular.module("ngRightsDirective",[]).directive("ngRights",["$parse","ngRights",function(t,e){return{restrict:"A",multiElement:!0,link:function(n,r,o){function i(t){var e=new RegExp(/([a-zA-Z1-9_$]+)(?:(\.)|\((.*)\))?/g),n=null;for(a=[],l="";null!==(n=e.exec(t));)if(a.push(n[1]),"."!==n[2]){l=n[3]||"";break}}function s(){for(var t=e.ruleset,n=0;n<a.length;n++){if(!t.hasOwnProperty(a[n]))return null;t=t[a[n]]}return t}function u(){var u;try{i(o.ngRights);var a=s();a?(u=a(n.$eval(t(l))),"boolean"!=typeof u&&(u=e.onErrorValue)):u=e.onErrorValue}catch(c){u=e.onErrorValue}r.css("display",u?"inherit":"none")}r.css("display","none");var a=[],l="";n.$on("ngRights-update",u),n.$watch(u)}}}]),angular.module("ngRightsProvider",[]).provider("ngRights",function(){function t(t,n,r,o){this.ruleset={},this.defaultRuleset=angular.copy(t),this.subjectGenerator=n,this.rootScope=o,this.onErrorValue=r,this.ruleset=e(this.defaultRuleset,n)}function e(t,n){for(var r={},o=0;o<Object.keys(t).length;o++){var i=Object.keys(t)[o],s=t[i];if(angular.isObject(s))r[i]=e(s,n);else if(angular.isFunction(s))r[i]=function(t){return function(e){return t(n(),e)}}(s);else{if("boolean"!=typeof s)throw new Error("Wrong rule definition, rules must be objects, functions or booleans.");r[i]=function(t){return function(){return t}}(s)}}return r}t.prototype.setRules=function(t){this.ruleset=e(t,this.subjectGenerator,this.onErrorValue),this.rootScope.$broadcast("ngRights-update")},t.prototype.addRules=function(t){angular.merge(this.ruleset,e(t,this.subjectGenerator)),this.rootScope.$broadcast("ngRights-update")},t.prototype.refresh=function(){this.rootScope.$broadcast("ngRights-update")};var n={},r=null,o=!1;this.setRules=function(t){n=t},this.setSubjectGenerator=function(t){r=t},this.setOnErrorDisplay=function(t){o=t},this.$get=["$rootScope",function(e){return window.ngRights=new t(n,r,o,e),window.ngRights}]});