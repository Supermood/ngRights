!function(t){t.module("ngRights",["ngRightsProvider","ngRightsDirective"])}(angular),angular.module("ngRightsDirective",[]).directive("ngRights",["$parse","ngRights",function(t,e){return{restrict:"A",multiElement:!0,link:function(r,n,o){function i(t){var e=new RegExp(/([a-zA-Z1-9_$]+)(?:(\.)|\((.*)\))?/g),r=null;for(u=[],a="";null!==(r=e.exec(t));)if(u.push(r[1]),"."!==r[2]){a=r[3]||"";break}}function s(){var s;try{i(o.ngRights),s=e.hasRight(u,r.$eval(t(a)))}catch(h){s=e.onErrorValue}n.css("display",s?"inherit":"none")}n.css("display","none");var u=[],a="";r.$on("ngRights-update",s),r.$watch(s)}}}]),angular.module("ngRightsProvider",[]).provider("ngRights",function(){function t(t,r,n,o){this.ruleset={},this.defaultRuleset=angular.copy(t),this.subjectGenerator=r,this.rootScope=o,this.onErrorValue=n,this.ruleset=e(this.defaultRuleset,r)}function e(t,r){for(var n={},o=0;o<Object.keys(t).length;o++){var i=Object.keys(t)[o],s=t[i];if(angular.isObject(s))n[i]=e(s,r);else if(angular.isFunction(s))n[i]=function(t){return function(e){return t(r(),e)}}(s);else{if("boolean"!=typeof s)throw new Error("Wrong rule definition, rules must be objects, functions or booleans.");n[i]=function(t){return function(){return t}}(s)}}return n}t.prototype.setRules=function(t){this.ruleset=e(t,this.subjectGenerator,this.onErrorValue),this.rootScope.$broadcast("ngRights-update")},t.prototype.addRules=function(t){angular.merge(this.ruleset,e(t,this.subjectGenerator)),this.rootScope.$broadcast("ngRights-update")},t.prototype.getRule=function(t){"string"==typeof t&&(t=t.split("."));for(var e=this.ruleset,r=0;r<t.length;r++){if(!e.hasOwnProperty(t[r]))throw new Error("The rule you are looking for wasn't found");e=e[t[r]]}return e},t.prototype.hasRight=function(t,e){var r=this.onErrorValue;try{var n=this.getRule(t);r=n(e),"boolean"!=typeof r&&(r=this.onErrorValue)}catch(o){r=this.onErrorValue}return r},t.prototype.refresh=function(){this.rootScope.$broadcast("ngRights-update")};var r={},n=null,o=!1;this.setRules=function(t){r=t},this.setSubjectGenerator=function(t){n=t},this.setOnErrorDisplay=function(t){o=t},this.$get=["$rootScope",function(e){return window.ngRights=new t(r,n,o,e),window.ngRights}]});